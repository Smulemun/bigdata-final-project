0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP DATABASE IF EXISTS team16_projectdb CASCADE;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE DATABASE team16_projectdb LOCATION "project/hive/warehouse";
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team16_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE ecom STORED AS AVRO LOCATION 'project/warehouse/ecom' TBLPROPERTIES ('avro.schema.url'='project/warehouse/avsc/ecom.avsc');
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM ecom LIMIT 100;
+----------------+------------------+------------------+------------------+----------------------+-----------------------------------------+-------------------+-------------+---------------+---------------------------------------+
| ecom.event_id  | ecom.event_time  | ecom.event_type  | ecom.product_id  |   ecom.category_id   |           ecom.category_code            |    ecom.brand     | ecom.price  | ecom.user_id  |           ecom.user_session           |
+----------------+------------------+------------------+------------------+----------------------+-----------------------------------------+-------------------+-------------+---------------+---------------------------------------+
| 8              | 1569877208000    | view             | 31500053         | 2053013558031024687  |                                         | luminarc          | 41.16       | 550978835     | 6280d577-25c8-4147-99a7-abc6048498d6  |
| 19             | 1569877219000    | view             | 1306631          | 2053013558920217191  | computers.notebook                      | hp                | 580.89      | 550050854     | 7c90fc70-0e80-4590-96f3-13c02c18c713  |
| 23             | 1569877222000    | view             | 1480714          | 2053013561092866779  | computers.desktop                       | pulser            | 921.49      | 512742880     | 0d0d91c2-c9c2-4e81-90a5-86594dec0db9  |
| 34             | 1569877227000    | view             | 10800001         | 2053013554994348409  |                                         | maxwell           | 32.92       | 539194858     | 5fe9d0a0-0de6-47de-a55a-eae9f89475cd  |
| 39             | 1569877231000    | view             | 3900746          | 2053013552326770905  | appliances.environment.water_heater     | haier             | 102.38      | 555444559     | 98b88fa0-d8fa-4b9d-8a71-3dd403afab85  |
| 48             | 1569877236000    | view             | 3600575          | 2053013563810775923  | appliances.kitchen.washer               | hotpoint-ariston  | 275.37      | 554754045     | bd0302ef-c5ca-4b6a-b916-95cc2840c72c  |
| 62             | 1569877250000    | view             | 19000296         | 2053013557225718275  |                                         | gran-stone        | 64.93       | 525734504     | 83f584ed-c7f7-442e-8ae9-713cb27fdece  |
| 65             | 1569877250000    | view             | 1307135          | 2053013558920217191  | computers.notebook                      | hp                | 320.35      | 542378517     | 244570b9-ebb4-4d4a-b63a-653225d975d5  |
| 76             | 1569877262000    | view             | 10900026         | 2053013555069845885  | appliances.kitchen.mixer                | panasonic         | 40.8        | 514080443     | b65b8d08-14af-496c-94cb-44886c6a96d5  |
| 86             | 1569877272000    | view             | 26500144         | 2053013563550729061  |                                         | lucente           | 259.21      | 525856698     | f72ea16b-4ec3-44f8-8fcd-35d89984b744  |
| 94             | 1569877283000    | view             | 10900026         | 2053013555069845885  | appliances.kitchen.mixer                | panasonic         | 40.8        | 514080443     | b65b8d08-14af-496c-94cb-44886c6a96d5  |
| 101            | 1569877288000    | view             | 3900815          | 2053013552326770905  | appliances.environment.water_heater     | ariston           | 133.82      | 531646433     | f19e3ef4-a4c3-48b3-8a2b-9533fcf5d727  |
| 109            | 1569877292000    | view             | 1004158          | 2053013555631882655  | electronics.smartphone                  | samsung           | 952.41      | 543427258     | 4fc3e61d-5f94-45bb-82dc-ac77f59b5870  |
| 117            | 1569877299000    | view             | 4100138          | 2053013561218695907  |                                         | sony              | 413.91      | 554610163     | 2e495bf2-4d5f-44b7-a711-a55c02e5512c  |
| 127            | 1569877304000    | view             | 1003317          | 2053013555631882655  | electronics.smartphone                  | apple             | 957.53      | 514218020     | d7c4761f-de75-454b-9164-177db5e53695  |
| 132            | 1569877307000    | view             | 1480456          | 2053013561092866779  | computers.desktop                       | pulser            | 1016.73     | 512742880     | 0d0d91c2-c9c2-4e81-90a5-86594dec0db9  |
| 146            | 1569877322000    | view             | 1004767          | 2053013555631882655  | electronics.smartphone                  | samsung           | 254.82      | 552783882     | 0ac92940-754e-4cee-baaf-e6a1701a7062  |
| 156            | 1569877330000    | view             | 1004767          | 2053013555631882655  | electronics.smartphone                  | samsung           | 254.82      | 513457407     | d6f9a1f2-f96f-4220-b393-ec697a3183c5  |
| 158            | 1569877332000    | view             | 1004949          | 2053013555631882655  | electronics.smartphone                  | oneplus           | 838.89      | 533205672     | 698f6680-5fcf-4bf0-af14-cea6366052d5  |
| 163            | 1569877334000    | purchase         | 1004856          | 2053013555631882655  | electronics.smartphone                  | samsung           | 130.76      | 543272936     | 8187d148-3c41-46d4-b0c0-9c08cd9dc564  |
| 172            | 1569877339000    | view             | 32800211         | 2055156924273394455  |                                         | rush              | 158.56      | 513696314     | 1c073854-b838-4cf9-bfe9-b30b742b1751  |
| 190            | 1569877353000    | view             | 50600002         | 2134905044833666047  | auto.accessories.compressor             |                   | 89.81       | 514933060     | 2f36c9e1-b1e1-4b56-99f2-f3a7bdf0307d  |
| 197            | 1569877361000    | view             | 1005115          | 2053013555631882655  | electronics.smartphone                  | apple             | 975.57      | 514218020     | d7c4761f-de75-454b-9164-177db5e53695  |
| 200            | 1569877366000    | view             | 3200321          | 2053013555321504139  | appliances.kitchen.meat_grinder         | redmond           | 91.38       | 515744951     | d35a2b1e-a781-45c4-a4f1-7e851d2a4c16  |
| 201            | 1569877367000    | view             | 1002532          | 2053013555631882655  | electronics.smartphone                  | apple             | 642.69      | 551377651     | 3c80f0d6-e9ec-4181-8c5c-837a30be2d68  |
| 213            | 1569877375000    | view             | 1005115          | 2053013555631882655  | electronics.smartphone                  | apple             | 975.57      | 516461845     | 545c5b25-a2db-4b48-84e4-7e44e7b0cf82  |
| 222            | 1569877385000    | view             | 4300285          | 2053013552385491165  |                                         | electrolux        | 102.94      | 544648245     | bb8e28c8-d11f-428a-95e7-056e974fe835  |
| 234            | 1569877396000    | view             | 1005101          | 2053013555631882655  | electronics.smartphone                  | xiaomi            | 450.46      | 539538500     | 9444337f-c3bd-4470-8ff2-85731d3522c5  |
| 239            | 1569877401000    | view             | 6200965          | 2053013552293216471  | appliances.environment.air_heater       | elenberg          | 36.01       | 555447228     | 1865d0ee-1f9b-4c7d-967a-43c0c1c481d7  |
| 257            | 1569877419000    | view             | 1004946          | 2053013555631882655  | electronics.smartphone                  | oneplus           | 746.22      | 533205672     | 698f6680-5fcf-4bf0-af14-cea6366052d5  |
| 261            | 1569877424000    | view             | 13400136         | 2053013557066334713  |                                         |                   | 88.26       | 552795065     | 92b3f9b0-2c8e-4719-8f12-c79ebdca74ee  |
| 265            | 1569877426000    | view             | 26300089         | 2053013563584283495  |                                         | lucente           | 271.82      | 552985520     | 7e776b9d-4f32-494f-9fbe-f293046cdd6c  |
| 266            | 1569877426000    | view             | 22700044         | 2053013556168753601  |                                         | total             | 43.73       | 513275557     | 4994e4b9-a3de-4ceb-8fc5-cd4d23809f8f  |
| 268            | 1569877428000    | view             | 21403078         | 2053013561579406073  | electronics.clocks                      | casio             | 39.05       | 525856698     | f72ea16b-4ec3-44f8-8fcd-35d89984b744  |
| 275            | 1569877438000    | view             | 10800084         | 2053013554994348409  |                                         | clatronic         | 58.52       | 539979421     | 613162b2-7159-400d-9f83-aa403985f0ba  |
| 284            | 1569877446000    | view             | 5100705          | 2053013553341792533  | electronics.clocks                      | garmin            | 1207.24     | 522806189     | 9fc424df-a04f-4051-8f18-4c637491d007  |
| 298            | 1569877463000    | view             | 27700113         | 2053013560086233771  | construction.tools.pump                 | leo               | 48.9        | 515630204     | f9cc0313-5572-4894-a4eb-45d855f064cc  |
| 311            | 1569877481000    | view             | 1004415          | 2053013555631882655  | electronics.smartphone                  | bq                | 42.45       | 513840435     | f13c75a5-7f6e-4467-a4e2-c1386c05b007  |
| 315            | 1569877486000    | view             | 37900138         | 2152167773222993940  |                                         | vega              | 31.27       | 552985520     | 7e776b9d-4f32-494f-9fbe-f293046cdd6c  |
| 325            | 1569877503000    | view             | 4300285          | 2053013552385491165  |                                         | electrolux        | 102.94      | 544648245     | bb8e28c8-d11f-428a-95e7-056e974fe835  |
| 349            | 1569877533000    | view             | 12703419         | 2053013553559896355  |                                         | cordiant          | 53.54       | 519791231     | 71249adf-78cc-44f1-b7e3-a6d5e90becb3  |
| 358            | 1569877541000    | view             | 1307365          | 2053013558920217191  | computers.notebook                      | lenovo            | 373.21      | 520575653     | 9acd3cb7-79b7-4293-bb81-bec02a1c9cd3  |
| 360            | 1569877541000    | view             | 1004966          | 2053013555631882655  | electronics.smartphone                  | oppo              | 257.38      | 523208885     | aa1644d3-047b-4bc5-b649-37c64fe41948  |
| 366            | 1569877548000    | view             | 1005130          | 2053013555631882655  | electronics.smartphone                  | apple             | 1619.09     | 544647372     | 596ff182-8e6b-4b27-bb55-1dc66cfb6bb6  |
| 381            | 1569877562000    | view             | 1004321          | 2053013555631882655  | electronics.smartphone                  | huawei            | 243.25      | 514336739     | cccc58c1-4986-4d08-b595-d837c0c7d514  |
| 411            | 1569877592000    | view             | 1004209          | 2053013555631882655  | electronics.smartphone                  | samsung           | 92.64       | 520775875     | a653ed61-904a-4804-bb87-f8e87443350a  |
| 414            | 1569877598000    | view             | 2701646          | 2053013563911439225  | appliances.kitchen.refrigerators        | indesit           | 270.02      | 515454339     | 2318d020-0e0d-4412-a3a1-a8eddeeb21a3  |
| 425            | 1569877610000    | view             | 3700766          | 2053013565983425517  | appliances.environment.vacuum           | samsung           | 128.45      | 555448298     | a4378fe7-5e6a-4b97-84ca-2cc8c9d4015f  |
| 468            | 1569877658000    | view             | 2701732          | 2053013563911439225  | appliances.kitchen.refrigerators        | lg                | 1248.34     | 551125341     | 24f95774-68ce-466a-8546-e781b92fe522  |
| 478            | 1569877670000    | view             | 1004433          | 2053013555631882655  | electronics.smartphone                  | samsung           | 257.15      | 516489361     | 7d6d03fb-39d6-4143-8694-981a550acaaa  |
| 493            | 1569877694000    | view             | 4600542          | 2053013563944993659  | appliances.kitchen.dishwasher           | beko              | 300.85      | 515342595     | 0e30e1c0-4d3e-4e1a-90e3-ab93b5f5c1a2  |
| 498            | 1569877702000    | view             | 17300136         | 2053013553853497655  |                                         | montale           | 102.96      | 512637377     | f9cbafba-4e4b-4196-97fa-f479465d072a  |
| 500            | 1569877703000    | view             | 34800106         | 2062461754293617058  |                                         |                   | 22.75       | 530659801     | af7ed87b-e918-4b31-bd24-475be2c19a3a  |
| 508            | 1569877711000    | view             | 26400193         | 2053013563651392361  |                                         |                   | 245.31      | 545196189     | 85b6f12c-76f8-4816-9d84-549ad4741e58  |
| 519            | 1569877724000    | view             | 1004741          | 2053013555631882655  | electronics.smartphone                  | xiaomi            | 185.71      | 554721115     | 8f95d593-d9d0-4627-aae3-f177bd7790f9  |
| 553            | 1569877756000    | view             | 16400155         | 2053013558249128509  |                                         | nadoba            | 164.71      | 553937622     | b98a1c5f-246f-4395-a925-42e8e87a98a9  |
| 554            | 1569877756000    | view             | 3601505          | 2053013563810775923  | appliances.kitchen.washer               | samsung           | 463.15      | 551125341     | 24f95774-68ce-466a-8546-e781b92fe522  |
| 562            | 1569877761000    | view             | 1801690          | 2053013554415534427  | electronics.video.tv                    | samsung           | 368.04      | 555447570     | 1859b15b-4681-4e79-b36b-021c02cfbeaf  |
| 564            | 1569877762000    | view             | 1004856          | 2053013555631882655  | electronics.smartphone                  | samsung           | 130.76      | 554242017     | 0d63a264-fedf-47d4-8286-e68b0cd5d8c5  |
| 572            | 1569877765000    | view             | 37000006         | 2075210504652981138  |                                         | x-game            | 167.81      | 551563536     | a81bcd36-e90f-44cd-ac76-39422f79f2ec  |
| 602            | 1569877793000    | view             | 3601505          | 2053013563810775923  | appliances.kitchen.washer               | samsung           | 463.15      | 527578593     | f73357d4-c392-46b9-ae66-83047235b5b7  |
| 611            | 1569877796000    | view             | 1004838          | 2053013555631882655  | electronics.smartphone                  | oppo              | 179.38      | 553420432     | 6d78f8a3-860e-48c0-8cfd-e491e9ec2ff1  |
| 613            | 1569877799000    | view             | 22700129         | 2053013556168753601  |                                         | stels             | 72.05       | 519650915     | 2da1c337-3263-4e45-8363-de359260ebfc  |
| 617            | 1569877803000    | view             | 19001139         | 2053013557225718275  |                                         | gran-stone        | 67.58       | 525734504     | 83f584ed-c7f7-442e-8ae9-713cb27fdece  |
| 643            | 1569877833000    | view             | 19001139         | 2053013557225718275  |                                         | gran-stone        | 67.58       | 525734504     | 83f584ed-c7f7-442e-8ae9-713cb27fdece  |
| 653            | 1569877841000    | view             | 3100871          | 2053013555262783879  | appliances.kitchen.blender              | vitek             | 23.14       | 515454339     | 2318d020-0e0d-4412-a3a1-a8eddeeb21a3  |
| 664            | 1569877850000    | view             | 24100265         | 2053013563307459413  |                                         |                   | 2.86        | 512637377     | 9cc0d7ba-50d3-4f55-9e92-c26c4d9e1bdf  |
| 667            | 1569877852000    | view             | 4300266          | 2053013552385491165  |                                         | vitek             | 28.24       | 521149112     | 9c91461e-5924-4ed4-b01b-4af180562459  |
| 683            | 1569877862000    | view             | 4200544          | 2053013552351936731  | appliances.environment.air_conditioner  | elenberg          | 229.07      | 551258664     | be0e1bd7-15c7-49d8-9b76-5ec1eea3ff39  |
| 691            | 1569877873000    | view             | 26204062         | 2053013563693335403  |                                         |                   | 244.28      | 515547943     | 4737b7aa-83f7-4899-86e0-2d53b2ddbffc  |
| 716            | 1569877900000    | view             | 1004870          | 2053013555631882655  | electronics.smartphone                  | samsung           | 286.86      | 516489361     | 7d6d03fb-39d6-4143-8694-981a550acaaa  |
| 720            | 1569877904000    | view             | 1004856          | 2053013555631882655  | electronics.smartphone                  | samsung           | 130.76      | 522453283     | cbec1077-a88b-4248-81d0-16be8d83df2f  |
| 727            | 1569877913000    | view             | 4201230          | 2053013552351936731  | appliances.environment.air_conditioner  | tcl               | 196.89      | 551258664     | be0e1bd7-15c7-49d8-9b76-5ec1eea3ff39  |
| 728            | 1569877913000    | view             | 6700998          | 2053013554247762257  | computers.components.videocards         | gigabyte          | 374.76      | 555448821     | 5b69e21b-f6e9-44ac-abbd-5f12c0a5c6c4  |
| 735            | 1569877925000    | view             | 1480161          | 2053013561092866779  | computers.desktop                       | acer              | 193.03      | 542378517     | 1229b0a7-1dbf-40f4-be8a-e4c02fd8c83a  |
| 741            | 1569877929000    | view             | 17200506         | 2053013559792632471  | furniture.living_room.sofa              |                   | 543.1       | 555448105     | 5b11f9ce-e784-4888-8dd4-adbd3d7058df  |
| 745            | 1569877931000    | view             | 28101121         | 2053013564918072245  |                                         |                   | 1698.89     | 521997271     | 44c0a5f1-6cec-4eb7-866e-87bbad74d4e1  |
| 755            | 1569877938000    | view             | 1480161          | 2053013561092866779  | computers.desktop                       | acer              | 193.03      | 542378517     | 1229b0a7-1dbf-40f4-be8a-e4c02fd8c83a  |
| 769            | 1569877948000    | view             | 6200971          | 2053013552293216471  | appliances.environment.air_heater       | willmark          | 10.27       | 535214649     | 6bd99f66-25fa-49bf-bc46-6977da0ab941  |
| 775            | 1569877955000    | view             | 4201230          | 2053013552351936731  | appliances.environment.air_conditioner  | tcl               | 196.89      | 521149112     | 9c91461e-5924-4ed4-b01b-4af180562459  |
| 799            | 1569877973000    | view             | 15100370         | 2053013557024391671  |                                         |                   | 257.15      | 543924190     | e6eae750-ca61-41da-a5c0-5867402c2717  |
| 831            | 1569878019000    | view             | 22700065         | 2053013556168753601  |                                         | aeroforce         | 150.82      | 547324534     | 17b7bb1b-1f67-4144-b966-6074c5cba161  |
| 841            | 1569878029000    | view             | 17300765         | 2053013553853497655  |                                         | lanvin            | 69.49       | 520694813     | b2e0c3e8-4158-4e40-b907-236be7fb9bf7  |
| 842            | 1569878031000    | view             | 12703421         | 2053013553559896355  |                                         | cordiant          | 59.2        | 519791231     | a21b72ad-b293-44e6-a942-a814533cdf6a  |
| 844            | 1569878036000    | view             | 1480608          | 2053013561092866779  | computers.desktop                       | pulser            | 380.94      | 512742880     | 1b7451ac-14e6-470f-a218-cdeb3e68dc21  |
| 866            | 1569878060000    | view             | 3901101          | 2053013552326770905  | appliances.environment.water_heater     | ariston           | 638.28      | 555442465     | 852b75d9-3c3d-4eb6-844e-70c3a5c24d93  |
| 869            | 1569878064000    | view             | 4803399          | 2053013554658804075  | electronics.audio.headphone             | jbl               | 33.21       | 521016406     | 77b61d9e-6caf-47b3-bdba-ed9cb830d448  |
| 879            | 1569878074000    | view             | 1005115          | 2053013555631882655  | electronics.smartphone                  | apple             | 975.57      | 548691513     | c4439a54-98b1-4e8f-9d0e-f22ce6b1dea5  |
| 888            | 1569878085000    | view             | 16400243         | 2053013558249128509  |                                         | granhel           | 164.74      | 551563536     | a81bcd36-e90f-44cd-ac76-39422f79f2ec  |
| 889            | 1569878086000    | view             | 1800930          | 2053013554415534427  | electronics.video.tv                    | sony              | 329.22      | 551382032     | 4334311a-0ed1-4dc7-8e00-a0e210050af2  |
| 894            | 1569878092000    | view             | 13300584         | 2053013557166998015  |                                         | askona            | 94.98       | 524515532     | 04045ea7-95c1-40fd-aa38-436d888fbd40  |
| 896            | 1569878096000    | view             | 1004767          | 2053013555631882655  | electronics.smartphone                  | samsung           | 254.82      | 546070834     | ce6dd2b3-330f-4ba5-962f-176c22b06e7b  |
| 898            | 1569878098000    | view             | 22700084         | 2053013556168753601  |                                         | force             | 241.94      | 529394039     | 41fbb210-93e8-4823-bb78-d6dee4340d45  |
| 909            | 1569878113000    | view             | 5600042          | 2053013552293216471  | appliances.environment.air_heater       | electrolux        | 84.69       | 535214649     | 6bd99f66-25fa-49bf-bc46-6977da0ab941  |
| 910            | 1569878115000    | view             | 1480428          | 2053013561092866779  | computers.desktop                       | acer              | 231.59      | 542378517     | 673efa91-486f-4a00-8d76-510a6b7034df  |
| 912            | 1569878116000    | view             | 1004258          | 2053013555631882655  | electronics.smartphone                  | apple             | 735.05      | 555449266     | b2473177-a3ba-486e-9839-411a661d6a72  |
| 951            | 1569878173000    | view             | 12600015         | 2053013554751078769  | appliances.kitchen.grill                | vitek             | 77.14       | 547200172     | 7fe78df0-92ab-4321-9fef-c840ba596103  |
| 955            | 1569878176000    | view             | 28401058         | 2053013566209917945  | accessories.bag                         | karya             | 100.39      | 547093079     | 6619868d-16c8-401d-8cdf-ca758c006ebc  |
| 964            | 1569878179000    | view             | 3601485          | 2053013563810775923  | appliances.kitchen.washer               | lg                | 308.65      | 542418394     | eb1cc965-a74e-4c64-ade8-87f8b51c7a28  |
| 973            | 1569878189000    | view             | 23301159         | 2053013561956893455  |                                         |                   | 28.31       | 515650236     | 1b923c56-2f92-40da-bf02-a7aaafafc4c4  |
+----------------+------------------+------------------+------------------+----------------------+-----------------------------------------+-------------------+-------------+---------------+---------------------------------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 